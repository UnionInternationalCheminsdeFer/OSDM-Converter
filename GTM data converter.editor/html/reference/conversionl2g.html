<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<title>Conversion details 108.1 to IRS 90918-10</title>
</head>

<body>
<h1>Conversion details 108.1 to IRS 90918-10</h1>


<h2>Parameters required for the import of 108.1 data</h2>
<p><ul>

<table border="1">
<tr><td>Parameter</td><td>Description</td></tr>
<tr><td>Country</td><td>Country used to assign the station codes provided without country in 108.1</td></tr>
<tr><td>Character Set</td><td>Character set to read the local characters in 108.1 station names</td></tr>
<tr><td>Time zone</td><td>Time zone used to transfer the date fields in 108.1 into complete date information</td></tr>
</table>
</ul></p>


<h2>Parameters required for the conversion of 108.1 data</h2>


<h3>Conversion Parameters</h3>
<p><ul>
<table border="1">
<tr><td>Parameter</td><td>Description</td></tr>
<tr><td>VAT Templates</td><td>Templates to create VAT tax information. Templates can be provided for different scope and countries. The template applies to regional constraints within the specified country. Templates with scope INTERNATIONAL are used additionally for regional constraints with connection points.</td><td>Add VAT details for different countries</td></tr>
<tr><td>Station Mapping</td><td>Mapping of nonstandard stations into real Merits station codes.</td></tr>
<tr><td>Fare station set mappings</td><td>Mapping of 108 station codes to fare station sets. This will be created automatically in case the fare station set codes are properly contained in the 108.1 data.</td></tr>
<tr><td>station to service constrained mapping</td><td>Mapping of 108 station codes to service constraints.</td></tr>
<tr><td>fare template</td><td>Template to create a fare in the 90918-10 data. The template must provide service class and price factor to create a fare. All required data for the 
final fare must be created except the regional validity and the price which come from 108.1 series and fares. <br/> 
A fixed price can be set, the all fares converted from series will have the same price.<br/>
The referenced data items must be defined in the General Tariff Model fare structure first. They can then be assigned to a fare template.
</td></tr>
</table>
</ul></p>


<h3>Fare template</h3>

<p><ul>

Data structures used in the fare template reference data in the final fare structure.<br/><br/> 


 <ul> <img src="../images/fare template.png" alt="fare templates"/> </ul>
 <br/><br/> 

<table border="1">
<tr><td>Content</td><td>Description</td></tr>
<tr><td>price factor</td><td>a factor to calculate the price depending on the price given in the 108.1 data. The factor is applied and the result is rounded to Euro-Cents</td></tr>
<tr><td>price</td><td>A fixed price that can be defined manually in the fare structure. If this price is set the price factor will not be applied and the series price is replaced by this price.</td></tr>
<tr><td>rounding mode</td><td>Rounding rule applied to the price. <br/><br/>

<ul>
<li> Up: rounding up to one cent</li>
<li> Down: rounding down to one cent</li>
<li> Half-Up: rounding up to one cent for 0.5 to 0.9 cents and down for 0.1 to 0.4 cents</li>
<li> Half-Down: rounding up to one cent for 0.6 to 0.9 cents and down for 0.1 to 0.5 cents</li>
<li> Half-Even: rounding half up if the left digit is odd, half down otherwise (preserves the mean value)</li>
</ul>
</td></tr>
<tr><td>data description</td><td>Text to name the fare template. This text as no effect on the final data.</td></tr>
<tr><td>Fare detail description</td><td>A detailed description can be added to the fare. The fare detail description is a text that must to be edited in the fare structure first. Then it can be selected in the fare template.</td></tr>
<tr><td>Id</td><td>- not in use - </td></tr>
<tr><td>Fare constraint bundle</td><td>Fare constraint bundle holding the main constraints of this type of fare.</td></tr>
<tr><td>Separate contract fare constraint bundle</td><td>Fare constraint bundle to be used in case the series is listed in the 108.1 TCVL file.</td></tr>
<tr><td>Individual contracts</td><td>Indicates whether the fare allows individual contracts (handling tickets and after sales per person)  </td></tr>
<tr><td>Legacy Conversion</td><td>Indicates whether the fare template creates fares that allow a reconversion into 108.1 data. A fare might allow reconversion or even be only included for reconversion. </td></tr>
<tr><td>Passenger Constraint</td><td>The passenger constraint to be applied with the fare. The passenger constraint must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Reduction Constraint</td><td>The reduction constraint to be applied with the fare. The reduction constraint must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Reservation parameter</td><td>The reservation parameter to be applied with the fare. The reservation parameter must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Service class</td><td>The service class to be applied with the fare. The service class must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Service constraint</td><td>The service constraint to be applied with the fare. The service constraint must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Service Level</td><td>The service level to be applied with the fare. The service level must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Text</td><td>The text naming the fare. The text must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
</table>

<p>The Fare Constraint Bundle holds the main constraints for a type of fare. It needs to be created within the fare structure data and holds the following constraints: </p>
<table border="1">
<tr><td>Content</td><td>Description</td></tr>
<tr><td>data Description</td><td>A descriptive text of the bundle which is used in the selection list to assign the bundle to a fare template</td></tr>
<tr><td>Combination constraint</td><td>The rules on how to combine fares with other fares.</td></tr>
<tr><td>Sales availability</td><td>The sales availability will be calculated from the validity in the 108.1 data. </td></tr>
<tr><td>Travel validity</td><td>The travel validity to be applied with the fare. The travel validity must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
<tr><td>Passenger limits</td><td>The upper and lower limit of passengers to be combined on a ticket. </td></tr>
<tr><td>Fulfillment Constraint</td><td>A fulfillment constraint to be added to the fare. The fulfillment constraint must be edited in the fare structure first and can then be selected in the fare template.</td></tr>
<tr><td>Personal data constraint</td><td>The personal data constraint to be applied with the fare. The personal data constraint must be edited in the fare structure first and can then be selected in the fare template. </td></tr>
</table>


<br/><br/>
Data structures for after sales rules and legacy accounting identifiers can be added to the fare template via the context menu (add child...). <br/>

The legacy accounting identifiers are not needed for conversion but can be used to set an tariff id per fare template to be used in the accounting. If the accounting identifier is missing the ids will be allocated automatically.
<br/>

The after sales templates should be added to define after sales rules. The rules can provide a factor to calculate the fee depending on the rule. The fee is calculated from the price of the fare multiplied by the fee factor and rounded to Euro-Cent.
 
<br/>
</ul></p>

<h2>Conversion</h2>

<p><ul><p><img src="../images/convertFromLegacy.png" alt="convert"/>Convert the data.<br/></ul></p>

<p><ul>Conversion has the following steps:<br/><br/>

	<ul>
	<li>deleting old conversion results</li>
	<li>create fare station sets from the fare station set code in the 108 station data</li>
	<li>create connection points and border point mappings</li>
	<li>update the station reference data with case sensitive station names and border point codes</li>
	<li>create sales validity constraints - all from/end dates in series and fares are connected, the set of intersections is created. Each intersection results in a sales availability constraint.</li>
	<li>creating carrier constraints for all carriers contained in the series</li>
	<li>conversion of series into fares</li>
	</ul>

</ul></p>

<h2>Converting a series</h2>

<p><ul>
A series is converted into a regional validity and a corresponding regional validity for the return. For each regional validity and sales availability and fare template a fare is created using the 108 fare data.
<br/><br/>

Converting of a series has the following steps:<br/><br/>

	<ul>
	<li>converting the series into a regional validity and a second regional validity for the reversed direction.
		<br/><br/>
		<ul>
			<li>identifying the connection points in case of transit series or series from a border point</li>
			<li>replacing stations by real stations, service constraints or fare descriptions using the mappings provided in the conversion parameter</li>
			<li>adding the service constraints and fare descriptions to the fare data</li> 
			<li>converting the departure station, the via station list and the arrival station into a regional validity.</li>		
		</ul>
		<br/><br/>
	</li>
	<li>creating the fare based on the fare template.</li>
	<li>calculating the price for each fare template and sales availability constraint.</li>
	<li>adding legacy accounting information to the fare</li>
	<li>adding the price to the fare data set if it is not yet there</li>		
	<li>adding the fare to the fare data set</li>
	</ul>
</ul></p>




</body>
</html>